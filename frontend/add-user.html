<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>إضافة مستخدم - HNU</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="modules.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img src="logo.png" alt="HNU logo" class="brand-logo" />
      <span class="brand-text">HNU — النظام المحاسبي</span>
    </div>
  </header>
  <main class="container">
    <section class="module-card">
      <h2>إضافة مستخدم جديد</h2>
      <form id="form-user">
        <div class="row">
          <label>الاسم الكامل<br><input name="name" required></label>
          <label>البريد الإلكتروني<br><input name="email" type="email" required></label>
        </div>
        <div class="row">
          <label>كلمة المرور<br><input name="password" type="password" required></label>
          <label>تأكيد كلمة المرور<br><input name="password2" type="password" required></label>
        </div>
        <div class="row">
          <label>الدور<br>
              <select name="role">
                <option>مشرف</option>
                <option>محاسب</option>
                <option>عارض</option>
                <option>مشرف أعلى</option>
              </select>
          </label>
        </div>
        <button class="primary">حفظ المستخدم</button>
      </form>
    </section>
  </main>

  <script src="admin-modules.js"></script>
  <script>
    document.getElementById('form-user').addEventListener('submit',async function(e){
      e.preventDefault();
      const f=new FormData(e.target);
      const obj = Object.fromEntries(f.entries());
      if(obj.password!==obj.password2){alert('كلمتا المرور غير متطابقتين');return}
      const res = await AdminAPI.apiFetch('/api/users/create',{method:'POST',body:JSON.stringify({name:obj.name,email:obj.email,role:obj.role,password:obj.password,status:'active'})});
      if(res.success){alert('تم الإنشاء');location.href='users-list.html'} else alert(res.error||'خطأ');
    })
  </script>
</body>
</html>